<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.0.3, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This manual documents the binary I/O stream class library, version
1.5. It was last updated on 26 February 2023.

Copyright Â© 2002 - 2005, 2008 Simon Peter

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.1 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with the Front-Cover texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.  A copy of the license is
included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify
this GNU Manual, like GNU software.  Copies published by the Free
Software Foundation raise funds for GNU development." -->
<title>Examples (Binary I/O stream class library 1.5)</title>

<meta name="description" content="Examples (Binary I/O stream class library 1.5)">
<meta name="keywords" content="Examples (Binary I/O stream class library 1.5)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Concept-Index.html" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Usage.html" rel="up" title="Usage">
<link href="Creating-architecture_002dindependent-file-formats.html" rel="prev" title="Creating architecture-independent file formats">
<style type="text/css">
<!--
div.example {margin-left: 3.2em}
-->
</style>


</head>

<body lang="en">
<div class="section-level-extent" id="Examples">
<div class="nav-panel">
<p>
Previous: <a href="Creating-architecture_002dindependent-file-formats.html" accesskey="p" rel="prev">Creating architecture-independent file formats</a>, Up: <a href="Usage.html" accesskey="u" rel="up">Usage</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Examples-1">2.10 Examples</h3>
<a class="index-entry-id" id="index-Examples"></a>

<p>To read some data (namely integers, floats and strings) from an
ordinary binary file on your filesystem, which was also created on
your architecture:
</p>
<div class="example">
<pre class="example-preformatted">#include &lt;binfile.h&gt;

binifstream     file(&quot;test.dat&quot;);
int             i;
float           f;
char            string[256];

// Read a 32-bit integer
i = file.readInt(4);

// Read an IEEE-754 single (32 bits)
f = file.readFloat(binio::Single);

// Read a string until newline or max. number of chars exceeded
file.readString(string, 256, '\n');
</pre></div>

<p>To do I/O on a file that was created on an x86 machine (i.e. Little
Endian, <abbr class="acronym">IEEE-754</abbr> floats), while your own architecture is
something different:
</p>
<div class="example">
<pre class="example-preformatted">#include &lt;binfile.h&gt;

binfstream     file;
int            i = 1234567;
long           pos;

// open the file &quot;x86.dat&quot; for reading and writing, but do not create
// it if it's not there.
file.open(&quot;x86.dat&quot;, binfbase::NoCreate);

// Check if we could cleanly open the file and bail out, if we
// couldn't.
if(file.error())
  return ERROR;

// Set Little Endian mode, with IEEE-754 floats.
file.setFlag(binio::BigEndian, false);   // remove flag
file.setFlag(binio::FloatIEEE);          // set flag

// as we just want a demonstration, we discard all read data right away.

// Read a 16-bit integer
file.readInt(2);

// Read an IEEE-754 double (64 bits)
file.readFloat(binio::Double);

// Remember our current position in the stream
pos = file.pos();

// Seek to the end of the file
file.seek(0, binio::End);

// Write our variable i, determining its size using sizeof()
file.writeInt(i, sizeof(i));

// Seek back to our former position
file.seek(pos);

// Read a byte from here
file.readInt(1);

// close the file again
file.close();

// and we're finished
return SUCCESS;
</pre></div>

<p>To wrap around a stream from the iostream library, reading data until
the end of the stream:
</p>
<div class="example">
<pre class="example-preformatted">#include &lt;fstream&gt;
#include &lt;binwrap.h&gt;

// Open the iostream stream for reading and writing in binary mode.
fstream file(&quot;test.dat&quot;, ios::in | ios::out | ios::bin);

// Wrap a binary input-only stream around it.
biniwstream bfile(&amp;file);

// Read (and immediately discard) 24-bit integers until the end
// of the stream.
while(!bfile.eof())
  bfile.readInt(3);
</pre></div>

</div>
<hr>
<div class="nav-panel">
<p>
Previous: <a href="Creating-architecture_002dindependent-file-formats.html">Creating architecture-independent file formats</a>, Up: <a href="Usage.html">Usage</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
